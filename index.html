<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIO - Bộ Công Cụ AI Toàn Diện</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #0d1117;
            --primary-blue: #58a6ff;
            --border-color: #30363d;
            --card-bg: #161b22;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --input-bg: #010409;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background-color: var(--dark-bg);
            color: var(--text-primary);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Thanh điều hướng bên cạnh (Sidebar) --- */
        .sidebar {
            width: 240px;
            background-color: var(--card-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        .sidebar h1 {
            font-size: 1.5rem;
            color: var(--primary-blue);
            margin-bottom: 30px;
            text-align: center;
        }
        .sidebar .nav-button {
            background: none;
            border: 1px solid transparent;
            color: var(--text-secondary);
            padding: 12px 15px;
            width: 100%;
            text-align: left;
            font-size: 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 8px;
            transition: background-color 0.2s, color 0.2s;
        }
        .sidebar .nav-button:hover {
            background-color: rgba(88, 166, 255, 0.1);
        }
        .sidebar .nav-button.active {
            background-color: var(--primary-blue);
            color: var(--dark-bg);
            font-weight: 600;
        }
        .sidebar .nav-button.disabled {
            color: #484f58;
            cursor: not-allowed;
        }
        .sidebar .footer {
            margin-top: auto;
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-align: center;
        }

        /* --- Khu vực nội dung chính --- */
        .main-content {
            flex-grow: 1;
            padding: 30px;
            overflow-y: auto;
        }
        .page {
            display: none; /* Mặc định ẩn tất cả các trang */
        }
        .page.active {
            display: block; /* Chỉ hiện trang được kích hoạt */
        }
        .page h2 {
            font-size: 2rem;
            color: var(--primary-blue);
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        .page p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        
        /* --- Các thành phần chung cho các công cụ --- */
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: 600; }
        .prompt-area, .text-input {
            width: 100%;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
        }
        .prompt-area { resize: vertical; min-height: 100px; }
        .action-button {
            background-color: var(--primary-blue);
            color: var(--dark-bg);
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        .action-button:hover { background-color: #79b8ff; }
        .action-button:disabled { background-color: var(--border-color); cursor: not-allowed; }
        .result-box {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-size: 1rem;
            color: var(--text-primary);
            min-height: 150px;
        }
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            border: 1px dashed var(--border-color);
            margin-top: 15px;
            display: block;
        }
        .placeholder-text {
             color: var(--text-secondary);
             padding: 20px;
             background-color: var(--card-bg);
             border-radius: 8px;
             border: 1px dashed var(--border-color);
        }
    </style>
</head>
<body>

    <nav class="sidebar">
        <h1>AIO - D2VN</h1>
        <!-- Các nút điều hướng, data-page trỏ tới id của trang tương ứng -->
        <button class="nav-button active" data-page="page-content">Viết Nội Dung</button>
        <button class="nav-button" data-page="page-image-analysis">Phân Tích Ảnh</button>
        <button class="nav-button" data-page="page-image-gen">Tạo Hình Ảnh</button>
        <button class="nav-button disabled" data-page="page-youtube">Phân Tích Video</button>
        <button class="nav-button disabled" data-page="page-bg-remove">Xóa Nền Ảnh</button>
        <button class="nav-button disabled" data-page="page-video-dl">Tải Video</button>
        
        <div class="footer">
            <p>&copy; 2025 d2vn.github.io</p>
        </div>
    </nav>

    <main class="main-content">
        <!-- Trang 1: Viết Nội Dung (Mặc định) -->
        <div id="page-content" class="page active">
            <h2>Viết Nội Dung</h2>
            <p>Nhập yêu cầu của bạn vào ô bên dưới và để AI viết nội dung giúp bạn. Ví dụ: "viết một bài thơ về mùa hè".</p>
            <div class="input-group">
                <label for="text-prompt">Yêu cầu của bạn</label>
                <textarea id="text-prompt" class="prompt-area" placeholder="Viết một email chuyên nghiệp để xin nghỉ phép..."></textarea>
            </div>
            <button id="generate-text-btn" class="action-button">Tạo Nội Dung</button>
            <div id="text-result" class="result-box">Kết quả sẽ hiện ở đây...</div>
        </div>

        <!-- Trang 2: Phân Tích Ảnh -->
        <div id="page-image-analysis" class="page">
            <h2>Phân Tích Ảnh</h2>
            <p>Tải lên một hình ảnh và yêu cầu AI phân tích, mô tả, hoặc trích xuất văn bản từ đó.</p>
            <div class="input-group">
                <label for="image-upload">Chọn ảnh</label>
                <input type="file" id="image-upload" accept="image/*" class="text-input">
            </div>
            <img id="image-preview-analysis" class="image-preview" src="" alt="Xem trước ảnh">
            <div class="input-group" style="margin-top: 15px;">
                <label for="image-prompt">Yêu cầu phân tích</label>
                <textarea id="image-prompt" class="prompt-area" placeholder="Mô tả chi tiết hình ảnh này. Hoặc: Trích xuất toàn bộ văn bản trong ảnh."></textarea>
            </div>
            <button id="analyze-image-btn" class="action-button">Phân Tích</button>
            <div id="image-result" class="result-box">Kết quả phân tích sẽ hiện ở đây...</div>
        </div>

        <!-- Trang 3: Tạo Hình Ảnh -->
        <div id="page-image-gen" class="page">
            <h2>Tạo Hình Ảnh</h2>
            <p>Mô tả ý tưởng của bạn, AI sẽ biến nó thành hình ảnh. (Chức năng này sử dụng mô hình Imagen 3).</p>
            <div class="input-group">
                <label for="image-gen-prompt">Mô tả hình ảnh bạn muốn tạo</label>
                <textarea id="image-gen-prompt" class="prompt-area" placeholder="Một chú mèo phi hành gia đang cưỡi tên lửa bay vào vũ trụ, phong cách hoạt hình..."></textarea>
            </div>
            <button id="generate-image-btn" class="action-button">Tạo Ảnh</button>
            <div class="result-box" style="text-align: center;">
                <img id="generated-image" class="image-preview" src="" alt="Ảnh do AI tạo ra sẽ hiện ở đây">
                <p id="image-gen-status">Chưa có ảnh nào được tạo.</p>
            </div>
        </div>
        
        <!-- Các trang chưa thể tích hợp (hiển thị thông báo) -->
        <div id="page-youtube" class="page">
            <h2>Phân Tích Video</h2>
            <div class="placeholder-text">
                <strong>Chức năng sắp ra mắt!</strong><br>
                Việc lấy phụ đề và phân tích video trực tiếp từ trình duyệt rất phức tạp và cần một máy chủ hỗ trợ (backend). Chúng tôi đang làm việc để sớm ra mắt tính năng này.
            </div>
        </div>

        <div id="page-bg-remove" class="page">
            <h2>Xóa Nền Ảnh</h2>
             <div class="placeholder-text">
                <strong>Chức năng sắp ra mắt!</strong><br>
                Việc xóa nền ảnh đòi hỏi các mô hình AI chuyên dụng và sức mạnh xử lý lớn, cần có sự hỗ trợ từ máy chủ (backend).
            </div>
        </div>

        <div id="page-video-dl" class="page">
            <h2>Tải Video</h2>
             <div class="placeholder-text">
                <strong>Không thể thực hiện trên trình duyệt.</strong><br>
                Vì lý do bảo mật và kỹ thuật, các trình duyệt web không cho phép tải trực tiếp video từ các nền tảng như YouTube. Chức năng này đòi hỏi một ứng dụng máy tính chuyên dụng.
            </div>
        </div>
    </main>
    
    <script>
        // --- PHẦN LOGIC JAVASCRIPT ---

        // Hàm chuyển đổi giữa các trang
        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('.sidebar .nav-button');
            const pages = document.querySelectorAll('.main-content .page');

            navButtons.forEach(button => {
                if (button.classList.contains('disabled')) return;

                button.addEventListener('click', () => {
                    // Bỏ active ở nút cũ, thêm active cho nút mới
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    // Ẩn trang cũ, hiện trang mới
                    const targetPageId = button.getAttribute('data-page');
                    pages.forEach(page => {
                        page.classList.remove('active');
                        if (page.id === targetPageId) {
                            page.classList.add('active');
                        }
                    });
                });
            });
        });

        // --- Hàm gọi API chung ---
        // Canvas sẽ tự động cung cấp key khi bạn chạy code này.
        const API_KEY = ""; 

        // --- LOGIC CHO TRANG 1: VIẾT NỘI DUNG ---
        const generateTextBtn = document.getElementById('generate-text-btn');
        const textPromptInput = document.getElementById('text-prompt');
        const textResultBox = document.getElementById('text-result');

        generateTextBtn.addEventListener('click', async () => {
            const prompt = textPromptInput.value;
            if (!prompt) {
                textResultBox.textContent = 'Vui lòng nhập yêu cầu của bạn.';
                return;
            }
            generateTextBtn.disabled = true;
            textResultBox.textContent = 'AI đang suy nghĩ...';

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                if (data.candidates && data.candidates[0]) {
                    textResultBox.textContent = data.candidates[0].content.parts[0].text;
                } else {
                    textResultBox.textContent = 'Xin lỗi, không thể tạo nội dung. Phản hồi từ API không hợp lệ.';
                }
            } catch (error) {
                console.error("Lỗi:", error);
                textResultBox.textContent = `Đã xảy ra lỗi: ${error.message}`;
            } finally {
                generateTextBtn.disabled = false;
            }
        });

        // --- LOGIC CHO TRANG 2: PHÂN TÍCH ẢNH ---
        const imageUpload = document.getElementById('image-upload');
        const imagePreview = document.getElementById('image-preview-analysis');
        const imagePromptInput = document.getElementById('image-prompt');
        const analyzeImageBtn = document.getElementById('analyze-image-btn');
        const imageResultBox = document.getElementById('image-result');
        let base64ImageData = null;

        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onloadend = () => {
                imagePreview.src = reader.result;
                base64ImageData = reader.result.split(',')[1]; // Lấy phần dữ liệu base64
            };
            reader.readAsDataURL(file);
        });

        analyzeImageBtn.addEventListener('click', async () => {
            const prompt = imagePromptInput.value;
            if (!base64ImageData) {
                imageResultBox.textContent = 'Vui lòng tải lên một hình ảnh.';
                return;
            }
            if (!prompt) {
                imageResultBox.textContent = 'Vui lòng nhập yêu cầu phân tích.';
                return;
            }
            analyzeImageBtn.disabled = true;
            imageResultBox.textContent = 'AI đang phân tích ảnh...';

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
            const payload = {
                contents: [{
                    parts: [
                        { text: prompt },
                        { inline_data: { mime_type: "image/jpeg", data: base64ImageData } }
                    ]
                }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                if (data.candidates && data.candidates[0]) {
                    imageResultBox.textContent = data.candidates[0].content.parts[0].text;
                } else {
                    imageResultBox.textContent = 'Xin lỗi, không thể phân tích ảnh. Phản hồi từ API không hợp lệ.';
                }
            } catch (error) {
                console.error("Lỗi:", error);
                imageResultBox.textContent = `Đã xảy ra lỗi: ${error.message}`;
            } finally {
                analyzeImageBtn.disabled = false;
            }
        });
        
        // --- LOGIC CHO TRANG 3: TẠO HÌNH ẢNH ---
        const generateImageBtn = document.getElementById('generate-image-btn');
        const imageGenPromptInput = document.getElementById('image-gen-prompt');
        const generatedImage = document.getElementById('generated-image');
        const imageGenStatus = document.getElementById('image-gen-status');

        generateImageBtn.addEventListener('click', async () => {
            const prompt = imageGenPromptInput.value;
            if (!prompt) {
                imageGenStatus.textContent = 'Vui lòng nhập mô tả cho ảnh.';
                return;
            }
            generateImageBtn.disabled = true;
            generatedImage.src = ""; // Xóa ảnh cũ
            imageGenStatus.textContent = 'AI đang vẽ... Vui lòng chờ trong giây lát.';

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${API_KEY}`;
            const payload = { instances: [{ prompt: prompt }], parameters: { "sampleCount": 1 } };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                if (data.predictions && data.predictions[0] && data.predictions[0].bytesBase64Encoded) {
                    generatedImage.src = `data:image/png;base64,${data.predictions[0].bytesBase64Encoded}`;
                    imageGenStatus.textContent = 'Tạo ảnh thành công!';
                } else {
                    imageGenStatus.textContent = 'Xin lỗi, không thể tạo ảnh. Phản hồi từ API không hợp lệ.';
                    console.log("API Response:", data);
                }
            } catch (error) {
                console.error("Lỗi:", error);
                imageGenStatus.textContent = `Đã xảy ra lỗi: ${error.message}`;
            } finally {
                generateImageBtn.disabled = false;
            }
        });

    </script>
</body>
</html>
